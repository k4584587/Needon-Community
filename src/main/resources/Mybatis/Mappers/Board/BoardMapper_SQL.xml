<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Board">

	<!-- <select id="list" resultType="Board">
		select * from nb_board_${category} where cm_ck=0 order by no desc, register_date desc;
	</select> -->
	
	<select id="listpage" resultType="Board">
		select * from nb_board_${category} 
		<where>
		
			<if test="keyword != null and search!='subcon'">
				${search} like CONCAT ('%', #{keyword}, '%')
			</if>
			<if test="keyword != null and search=='subcon'">
				subject like CONCAT ('%', #{keyword}, '%') or
				content like CONCAT ('%', #{keyword}, '%')
			</if>
			
		</where> order by no desc, register_date desc
		limit #{pageStart}, #{perPageNum};
	</select>
	
	<select id="view" resultType="Board">
		select * from nb_board_${category} where no = #{no};
	</select>
	
	<select id="listcount" resultType="int">
		select count(no) from nb_board_${category}
		<where>
			<if test="keyword != null and search !='subcon'">
				${search} like CONCAT ('%', #{keyword}, '%')
			</if>
			<if test="keyword != null and search=='subcon'">
				subject like CONCAT ('%', #{keyword}, '%') or
				content like CONCAT ('%', #{keyword}, '%')
			</if>
		</where>;
	</select>
	
	<update id="viewcount" parameterType="int">
		update nb_board_${category} set read_count=read_count+1
		where no=#{no};
	</update>
	
	<insert id="insert">
		INSERT INTO nb_board_${category} (subject, content, file, ip, wr_no) 
		VALUES (#{subject}, #{content}, #{file}, #{ip}, #{wr_no});
	</insert>
	
	<delete id="delete">
		DELETE FROM nb_board_${category} WHERE no = #{no};
		ALTER TABLE nb_board_notice AUTO_INCREMENT=1;	
	</delete>
	
	<update id="modify">
		update nb_board_${category} set subject=#{subject}, content=#{content}, file=#{file, jdbcType=BLOB},
		ip=#{ip, jdbcType=VARCHAR}, register_date=#{register_date} where no = #{no};
	</update>
	

</mapper>
